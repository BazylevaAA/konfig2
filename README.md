# Dependency Visualizer

## 1. Общее описание
Dependency Visualizer — это инструмент для автоматического построения графа зависимостей пакетов NuGet с использованием PlantUML. Программа взаимодействует с NuGet API для извлечения зависимостей выбранного пакета, генерирует соответствующий PlantUML-скрипт и визуализирует граф зависимостей в виде PNG-изображения.

## 2. Описание всех функций и настроек

### Функции

#### `get_package_dependencies(package_name)`
Запрашивает зависимости для указанного пакета из NuGet API.
- **Параметры:**
  - `package_name` (str): Имя пакета.
- **Возвращает:**
  - Словарь, где ключи — версии пакета, а значения — списки его зависимостей.
- **Особенности:**
  - Обрабатывает отсутствие зависимостей или ошибки запроса.

#### `generate_complex_plantuml_script(package_name, dependencies)`
Генерирует PlantUML-скрипт на основе списка зависимостей.
- **Параметры:**
  - `package_name` (str): Имя пакета.
  - `dependencies` (list): Список зависимостей.
- **Возвращает:**
  - Строку с PlantUML-скриптом.

#### `save_plantuml_script(script, script_path)`
Сохраняет PlantUML-скрипт в файл.
- **Параметры:**
  - `script` (str): Строка с содержимым скрипта.
  - `script_path` (str): Путь к файлу для сохранения.
- **Особенности:**
  - Обрабатывает ошибки сохранения.

#### `load_config(config_path)`
Загружает конфигурационный файл TOML.
- **Параметры:**
  - `config_path` (str): Путь к конфигурационному файлу.
- **Возвращает:**
  - Словарь с параметрами конфигурации.
- **Особенности:**
  - Проверяет наличие обязательных ключей.

#### `generate_graph(plantuml_path, script_path, output_image_path)`
Создает PNG-граф на основе PlantUML-скрипта.
- **Параметры:**
  - `plantuml_path` (str): Путь к PlantUML JAR-файлу.
  - `script_path` (str): Путь к PlantUML-скрипту.
  - `output_image_path` (str): Путь для сохранения результата.

#### `main()`
Основная функция программы. Выполняет:
1. Загрузку конфигурации.
2. Получение зависимостей пакета.
3. Генерацию PlantUML-скрипта.
4. Сохранение скрипта.
5. Генерацию графа.

### Настройки
Конфигурационный файл `config.toml` содержит:
- `visualizer_path` (str): Путь к JAR-файлу PlantUML.
- `package_name` (str): Имя пакета для анализа.
- `output_path` (str): Путь для сохранения PNG-изображения графа.

Пример:
```toml
visualizer_path = "path/to/plantuml.jar"
package_name = "Newtonsoft.Json"
output_path = "output/dependencies.png"
```

## 3. Описание команд для сборки проекта

1. Установите зависимости Python:
   ```bash
   pip install requests toml
   ```

2. Убедитесь, что Java установлена и доступна в PATH.

3. Скачайте PlantUML JAR-файл:
   ```bash
   wget https://sourceforge.net/projects/plantuml/files/plantuml.jar
   ```

4. Запустите программу:
   ```bash
   python main.py
   ```
Это создаст файл generate_img.puml и сгенерирует изображение зависимостей.

Пример визуализации: ![img_1.png](img_1.png)

## Результаты прогона тестов
Для запуска тестов используйте команду:
```bash
python -m unittest test.py
 ```
Пример вывода после успешного прохождения тестов:
![img.png](img.png)

### Примечания:
Все тесты проходят успешно, включая проверку загрузки конфигурации, генерации скриптов и графиков, а также работы с subprocess для создания изображений.

В тестах используется mocking для проверки вызовов функций без фактического взаимодействия с файловой системой или внешними программами.

